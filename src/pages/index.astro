---
import PageLayout from '~/layouts/PageLayout.astro';
import heroVideo from '~/assets/videos/hero.mp4';
import Logo from '~/assets/icons/logo.svg';

// Section components
import Introduction from '~/components/sections/Introduction.astro';
import KeyNumbers from '~/components/sections/KeyNumbers.astro';
import FullBleedDivider from '~/components/sections/FullBleedDivider.astro';
import Location from '~/components/sections/Location.astro';
import Qualities from '~/components/sections/Qualities.astro';
import BrandCarousel from '~/components/sections/BrandCarousel.astro';
import HousesListing from '~/components/sections/HousesListing.astro';
import ViviendaAMedida from '~/components/sections/ViviendaAMedida.astro';
import AboutClement from '~/components/sections/AboutClement.astro';
import Contact from '~/components/sections/Contact.astro';
import Sustainability from '~/components/sections/Sustainability.astro';
import VistaAerea from '~/components/sections/VistaAerea.astro';

// Divider images
import poolViewSunset from '~/assets/images/renders/pool-view-sunset.png';
import kitchen from '~/assets/images/renders/kitchen.jpg';
import rooftop1 from '~/assets/images/renders/rooftop-1.jpg';
---

<PageLayout
  metadata={{
    title: 'CLEMENT Puerta de Hierro - Chalets de Gran Lujo en Madrid',
    description: 'Descubre los 6 chalets Gran Lujo de la línea GOLD HOME en la prestigiosa Urbanización Puerta de Hierro, Madrid. Más de 400 m² construidos, piscina privada, seguridad 24h y calificación energética A.',
  }}
>

<div slot="header"></div>

<!-- 1. Hero -->
<section id="top" class="relative w-full h-screen overflow-hidden flex items-center justify-center">
  <video
    class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 min-w-full min-h-full w-auto h-full object-cover -z-20"
    autoplay
    muted
    loop
    playsinline
  >
    <source src={heroVideo} type="video/mp4" />
  </video>

  <div class="absolute inset-0 bg-linear-to-b from-black/10 via-black/30 to-black/50 -z-10"></div>

  <div class="flex flex-col items-center justify-center text-center p-8 z-10 animate-fade-in-up">
    <Logo class="w-[min(500px,80vw)] h-auto brightness-0 invert mb-12" />

    <p class="font-serif text-2xl md:text-3xl text-white/90 font-light tracking-wide max-w-[600px] leading-relaxed italic">
      Tu nuevo hogar te espera
    </p>

    <a
      id="hero-cta"
      href="#contacto"
      class="mt-10 bg-gray-200 hover:bg-gray-800 text-gray-800 hover:text-white font-medium text-base px-10 py-4 rounded-full inline-flex items-center gap-2 transition-all shadow-lg hover:shadow-xl hover:scale-105"
    >
      Solicitar información
      <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
      </svg>
    </a>

    <a href="#estado-obra" class="mt-12 flex flex-col items-center text-white/60 hover:text-white transition-colors group">
      <span class="text-xs tracking-[0.25em] uppercase mb-3">Descubre</span>
      <svg class="w-5 h-5 animate-bounce" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 13.5 12 21m0 0-7.5-7.5M12 21V3" />
      </svg>
    </a>
  </div>
</section>

<!-- Status Banner -->
<section id="estado-obra" class="bg-linear-to-r from-secondary to-primary py-5">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 flex flex-col sm:flex-row items-center justify-center gap-4 sm:gap-16">
    <div class="flex items-center gap-3">
      <span class="relative flex h-3 w-3">
        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-300 opacity-75"></span>
        <span class="relative inline-flex rounded-full h-3 w-3 bg-green-400"></span>
      </span>
      <p class="text-white font-semibold tracking-[0.15em] uppercase text-sm md:text-base">Obras iniciadas</p>
    </div>
    <div class="hidden sm:block w-px h-8 bg-white/30"></div>
    <div class="flex items-center gap-3">
      <svg class="w-5 h-5 text-white/80" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5" />
      </svg>
      <p class="text-white/90 font-medium tracking-widest uppercase text-sm md:text-base">Entrega 3er trimestre 2027</p>
    </div>
  </div>
</section>

<!-- 2. Introduction + Dossier -->
<Introduction />



<!-- 3. Key Numbers -->
<KeyNumbers />

<!-- 4. Divider: Pool View Sunset -->
<FullBleedDivider
  image={poolViewSunset}
  alt="Vista de la piscina al atardecer"
  quote="Donde el lujo se encuentra con la naturaleza"
/>

<!-- 5. Vista Aérea / Development Overview -->
<VistaAerea />

<!-- 6. Location -->
<Location />

<!-- 6. Qualities / Features -->
<Qualities />

<!-- 7. Divider: Kitchen -->
<FullBleedDivider
  image={kitchen}
  alt="Cocina de diseño"
  quote="Cada detalle pensado para ti"
/>

<!-- 8. Brand Carousel -->
<BrandCarousel />

<!-- 2b. Sustainability / Energy Rating -->
<Sustainability />

<!-- 9. Houses Listing + Floorplans -->
<HousesListing />

<!-- 11. About Clement -->
<AboutClement />

<!-- 10. Vivienda a Medida -->
<ViviendaAMedida />

<!-- 12. Divider: Rooftop -->
<FullBleedDivider
  image={rooftop1}
  alt="Terraza con vistas"
  quote="Tu hogar, tu legado"
/>

<!-- 13. Contact CTA -->
<Contact />

<!-- Floating CTA Button (hidden by default, shown when hero CTA scrolls out of view) -->
<a
  id="floating-cta"
  href="#contacto"
  class="fixed bottom-6 left-1/2 -translate-x-1/2 z-50 cta-gradient whitespace-nowrap inline-flex items-center gap-2 font-medium text-sm px-8! py-3.5! shadow-2xl hover:shadow-xl hover:scale-105 opacity-0 translate-y-4 pointer-events-none"
  style="transition: opacity 0.5s cubic-bezier(0.16, 1, 0.3, 1), transform 0.5s cubic-bezier(0.16, 1, 0.3, 1);"
  aria-label="Solicitar información"
>
  Solicitar información
  <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
  </svg>
</a>

<script is:inline>
  (function () {
    var heroCta = document.getElementById('hero-cta');
    var floatingCta = document.getElementById('floating-cta');
    var contactSection = document.getElementById('contacto');
    if (!heroCta || !floatingCta) return;

    var heroOut = false;
    var contactVisible = false;

    function updateFloating() {
      var show = heroOut && !contactVisible;
      if (show) {
        floatingCta.classList.remove('opacity-0', 'translate-y-4', 'pointer-events-none');
        floatingCta.classList.add('opacity-100', 'translate-y-0', 'pointer-events-auto');
      } else {
        floatingCta.classList.add('opacity-0', 'translate-y-4', 'pointer-events-none');
        floatingCta.classList.remove('opacity-100', 'translate-y-0', 'pointer-events-auto');
      }
    }

    // Observe the hero CTA button
    var heroObserver = new IntersectionObserver(
      function (entries) {
        heroOut = !entries[0].isIntersecting;
        updateFloating();
      },
      { threshold: 0 }
    );
    heroObserver.observe(heroCta);

    // Observe the contact section so we hide the floating CTA when the user reaches it
    if (contactSection) {
      var contactObserver = new IntersectionObserver(
        function (entries) {
          contactVisible = entries[0].isIntersecting;
          updateFloating();
        },
        { threshold: 0.1 }
      );
      contactObserver.observe(contactSection);
    }
  })();
</script>

</PageLayout>
